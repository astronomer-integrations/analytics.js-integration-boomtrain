{
"/Users/terenceli/Boomtrain/segment/analytics.js-integration-boomtrain/lib/index.js":{"path":"/Users/terenceli/Boomtrain/segment/analytics.js-integration-boomtrain/lib/index.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":12,"7":12,"8":1,"9":2,"10":1,"11":7,"12":1,"13":6,"14":6,"15":6,"16":6,"17":1,"18":1,"19":2,"20":2,"21":2,"22":2,"23":1,"24":1,"25":1,"26":1,"27":2,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":2,"35":2,"36":0,"37":1},"b":{"1":[12,12],"2":[2,1],"3":[1,6],"4":[1,5],"5":[2,1],"6":[2,2],"7":[0,2],"8":[2,0]},"f":{"1":12,"2":2,"3":7,"4":2,"5":1,"6":2,"7":1},"fnMap":{"1":{"name":"(anonymous_1)","line":27,"loc":{"start":{"line":27,"column":33},"end":{"line":27,"column":44}}},"2":{"name":"(anonymous_2)","line":39,"loc":{"start":{"line":39,"column":29},"end":{"line":39,"column":40}}},"3":{"name":"(anonymous_3)","line":52,"loc":{"start":{"line":52,"column":31},"end":{"line":52,"column":50}}},"4":{"name":"(anonymous_4)","line":71,"loc":{"start":{"line":71,"column":27},"end":{"line":71,"column":42}}},"5":{"name":"(anonymous_5)","line":87,"loc":{"start":{"line":87,"column":28},"end":{"line":87,"column":44}}},"6":{"name":"convertDate","line":100,"loc":{"start":{"line":100,"column":0},"end":{"line":100,"column":27}}},"7":{"name":"getModel","line":112,"loc":{"start":{"line":112,"column":0},"end":{"line":112,"column":20}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":53}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":63}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":36}},"4":{"start":{"line":14,"column":0},"end":{"line":17,"column":110}},"5":{"start":{"line":27,"column":0},"end":{"line":30,"column":2}},"6":{"start":{"line":28,"column":2},"end":{"line":28,"column":32}},"7":{"start":{"line":29,"column":2},"end":{"line":29,"column":24}},"8":{"start":{"line":39,"column":0},"end":{"line":41,"column":2}},"9":{"start":{"line":40,"column":2},"end":{"line":40,"column":68}},"10":{"start":{"line":52,"column":0},"end":{"line":60,"column":2}},"11":{"start":{"line":53,"column":2},"end":{"line":53,"column":64}},"12":{"start":{"line":53,"column":26},"end":{"line":53,"column":64}},"13":{"start":{"line":54,"column":2},"end":{"line":54,"column":60}},"14":{"start":{"line":55,"column":2},"end":{"line":55,"column":45}},"15":{"start":{"line":56,"column":2},"end":{"line":56,"column":32}},"16":{"start":{"line":57,"column":2},"end":{"line":59,"column":3}},"17":{"start":{"line":58,"column":4},"end":{"line":58,"column":40}},"18":{"start":{"line":71,"column":0},"end":{"line":76,"column":2}},"19":{"start":{"line":72,"column":2},"end":{"line":72,"column":37}},"20":{"start":{"line":73,"column":2},"end":{"line":73,"column":52}},"21":{"start":{"line":74,"column":2},"end":{"line":74,"column":45}},"22":{"start":{"line":75,"column":2},"end":{"line":75,"column":77}},"23":{"start":{"line":87,"column":0},"end":{"line":90,"column":2}},"24":{"start":{"line":88,"column":2},"end":{"line":88,"column":38}},"25":{"start":{"line":89,"column":2},"end":{"line":89,"column":46}},"26":{"start":{"line":100,"column":0},"end":{"line":102,"column":1}},"27":{"start":{"line":101,"column":2},"end":{"line":101,"column":43}},"28":{"start":{"line":112,"column":0},"end":{"line":124,"column":1}},"29":{"start":{"line":113,"column":2},"end":{"line":113,"column":62}},"30":{"start":{"line":114,"column":2},"end":{"line":114,"column":16}},"31":{"start":{"line":115,"column":2},"end":{"line":115,"column":22}},"32":{"start":{"line":116,"column":2},"end":{"line":116,"column":23}},"33":{"start":{"line":117,"column":2},"end":{"line":122,"column":3}},"34":{"start":{"line":118,"column":4},"end":{"line":118,"column":77}},"35":{"start":{"line":119,"column":4},"end":{"line":121,"column":5}},"36":{"start":{"line":120,"column":6},"end":{"line":120,"column":80}},"37":{"start":{"line":123,"column":2},"end":{"line":123,"column":19}}},"branchMap":{"1":{"line":28,"type":"binary-expr","locations":[{"start":{"line":28,"column":15},"end":{"line":28,"column":25}},{"start":{"line":28,"column":29},"end":{"line":28,"column":31}}]},"2":{"line":40,"type":"binary-expr","locations":[{"start":{"line":40,"column":12},"end":{"line":40,"column":22}},{"start":{"line":40,"column":26},"end":{"line":40,"column":66}}]},"3":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":2},"end":{"line":53,"column":2}},{"start":{"line":53,"column":2},"end":{"line":53,"column":2}}]},"4":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":2},"end":{"line":57,"column":2}},{"start":{"line":57,"column":2},"end":{"line":57,"column":2}}]},"5":{"line":73,"type":"binary-expr","locations":[{"start":{"line":73,"column":21},"end":{"line":73,"column":37}},{"start":{"line":73,"column":41},"end":{"line":73,"column":51}}]},"6":{"line":118,"type":"binary-expr","locations":[{"start":{"line":118,"column":19},"end":{"line":118,"column":43}},{"start":{"line":118,"column":47},"end":{"line":118,"column":76}}]},"7":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":4},"end":{"line":119,"column":4}},{"start":{"line":119,"column":4},"end":{"line":119,"column":4}}]},"8":{"line":119,"type":"binary-expr","locations":[{"start":{"line":119,"column":8},"end":{"line":119,"column":16}},{"start":{"line":119,"column":20},"end":{"line":119,"column":43}}]}},"code":["(function () { 'use strict';","/**"," * Module dependencies."," */","","var convertDates = require('@segment/convert-dates');","var integration = require('@segment/analytics.js-integration');","var md5 = require('spark-md5').hash;","","/**"," * Expose `Boomtrain` integration."," */","","var Boomtrain = module.exports = integration('Boomtrain')","  .global('_bt')","  .option('apiKey', '')","  .tag('<script src=\"https://cdn.boomtrain.com/analyticstrain/{{ apiKey }}/analyticstrain.min.js\"></script>');","","/**"," * Initialize."," *"," *"," *"," * @api public"," */","","Boomtrain.prototype.initialize = function() {","  window._bt = window._bt || [];","  this.load(this.ready);","};","","/**"," * Loaded?"," *"," * @api private"," * @return {boolean}"," */","","Boomtrain.prototype.loaded = function() {","  return !!(window._bt && window._bt.push !== Array.prototype.push);","};","","/**"," * Identify."," *"," *"," *"," * @api public"," * @param {Identify} identify"," */","","Boomtrain.prototype.identify = function(identify) {","  if (!identify.userId()) return this.debug('user id required');","  var traits = identify.traits({ createdAt: 'created_at' });","  traits = convertDates(traits, convertDate);","  window._bt.person.set(traits);","  if (traits.user_id) {","    window._bt.identify(traits.user_id);","  }","};","","/**"," * Page."," *"," *"," *"," * @api public"," * @param {Page} page"," */","","Boomtrain.prototype.page = function(page) {","  var properties = page.properties();","  properties.model = properties.model || getModel();","  properties.id = md5(page.properties().url);","  window._bt.track('viewed', { model: properties.model, id: properties.id });","};","","/**"," * Track."," *"," *"," *"," * @api public"," * @param {Track} track"," */","","Boomtrain.prototype.track = function(track) {","  var properties = track.properties();","  window._bt.track(track.event(), properties);","};","","/**"," * Convert a date to the format Boomtrain supports."," *"," * @api private"," * @param {Date} date"," * @return {number}"," */","","function convertDate(date) {","  return Math.floor(date.getTime() / 1000);","}","","/**"," * Get model of page, stored under meta-tag with property \"og:type\""," *"," * @api private"," * @param"," * @return {string}"," */","","function getModel() {","  var elements = window.document.getElementsByTagName('meta');","  var data = {};","  var pattern = 'og:';","  var key = 'property';","  for (var i = elements.length - 1; i >= 0; i--) {","    var property = elements[i].getAttribute && elements[i].getAttribute(key);","    if (property && property.match(pattern)) {","      data[property.replace(pattern, '')] = elements[i].getAttribute('content');","    }","  }","  return data.type;","}","","}());"],"l":{"6":1,"7":1,"8":1,"14":1,"27":1,"28":12,"29":12,"39":1,"40":2,"52":1,"53":7,"54":6,"55":6,"56":6,"57":6,"58":1,"71":1,"72":2,"73":2,"74":2,"75":2,"87":1,"88":1,"89":1,"100":1,"101":2,"112":1,"113":1,"114":1,"115":1,"116":1,"117":1,"118":2,"119":2,"120":0,"123":1}}}
